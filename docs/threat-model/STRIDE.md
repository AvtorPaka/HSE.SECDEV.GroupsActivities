# STRIDE, SecDev Groups Activities

| Поток/Элемент | Категория (STRIDE) | Угроза | Контроль | Ссылка на NFR |
| :--- | :--- | :--- | :--- | :--- |
| **F1** `(email, password)` | Spoofing | Злоумышленник подбирает пароль пользователя (брутфорс). | Ограничение числа попыток входа (rate limiting). | `NFR-02` |
| **F1** `(email, password)` | Information Disclosure | Злоумышленник определяет существующие в системе email'ы по разным ответам сервера. | Стандартизированные, общие сообщения об ошибках аутентификации. | `NFR-04` |
| **F1, F7** (весь трафик) | Tampering | Атакующий (MitM) изменяет данные в запросе/ответе, например, подменяя ID ресурса. | Использование TLS (HTTPS) обеспечивает целостность данных. HSTS предотвращает downgrade-атаки. | `NFR-07` - требует наличия TLS/SSL |
| **PostgreSQL DB** | Information Disclosure | Утечка БД и последующий оффлайн-перебор паролей. | Хэширование паролей с использованием bcrypt и достаточного cost factor. | `NFR-01` |
| **F6** `(Set-Cookie)` | Elevation of Privilege | Кража cookie через XSS-атаку из-за отсутствия флага `HttpOnly`. | Обязательная установка флага `HttpOnly` для всех сессионных cookie. | `NFR-07` |
| **F6** `(Set-Cookie)` | Information Disclosure | Перехват cookie на небезопасном соединении из-за отсутствия флага `Secure`. | Обязательная установка флага `Secure` для всех сессионных cookie. | `NFR-07` |
| **Groups Activities Service** | Repudiation | Отсутствие записей о том, кто и когда выполнял ключевые действия. | Ведение аудиторских логов для всех событий аутентификации и изменения данных. | `NFR-05` |
| **F7** `(Cookie)` | Spoofing | Межсайтовая подделка запроса (CSRF), использующая cookie пользователя. | Использование флага `SameSite=Lax` или `Strict` для cookie. | `NFR-08` |
| **F9** `(session_id)` | Spoofing | Повторное использование украденного или протухшего cookie для доступа к системе. | Проверка времени жизни сессии (TTL) при каждом запросе к защищенным ресурсам. | `NFR-03` |
| **Groups Activities Service** | Denial of Service | Чрезмерная нагрузка на эндпоинт `/login` вызывает отказ в обслуживании. | Ограничение частоты запросов и мониторинг производительности. | `NFR-06` |
| **F12** (Core Logic) | Denial of Service | Аутентифицированный пользователь создает тысячи "тяжелых" объектов (групп), исчерпывая ресурсы БД. | Rate limiting на ресурсоемкие операции для аутентифицированных пользователей. | `NFR-06`  |
| **F3** `(email, password)` | Information Disclosure | Передача открытого пароля в БД расширяет периметр компрометации. | Сервис должен запрашивать из БД только хэш по `email` и выполнять проверку пароля в своей памяти. | `NFR-01` |
