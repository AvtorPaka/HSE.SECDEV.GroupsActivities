# NFR, SecDev Groups Activities

| ID | Название | Описание | Метрика/Порог | Проверка (чем/где) | Компонент | Приоритет |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **NFR-01** | **Надёжное хэширование паролей (bcrypt)** | Пароли пользователей должны хэшироваться с использованием алгоритма bcrypt с достаточным фактором сложности для защиты от перебора. | Алгоритм: **bcrypt**. Фактор стоимости (cost factor): **≥ 12**. | Unit-тесты, проверяющие cost factor в хэше; ревью кода `PasswordHasher`. | `security-auth` | **High** |
| **NFR-02** | **Защита от подбора учётных данных** | Ограничение количества неудачных попыток входа для одного IP-адреса для предотвращения brute-force атак. | **≤ 10 неудачных попыток** входа с одного IP в течение **1 минуты**. | Функциональные (e2e/unit на контроллеры) тесты, имитирующие спам неверными `credentials` - rate limit клиента c `HTTP-429` ответом. | `security-auth` | **High** |
| **NFR-03** | **Контроль времени жизни сессии** | Пользовательские сессии должны автоматически прекращаться после периода неактивности для снижения риска захвата сессии. | Время жизни сессии (TTL): **3 часа** неактивности. | Интеграционный тест (с проверкой в `PgSQL`) / unit тест объекта сервиса авторизации, проверяющий `expiration_date` создаваемой сессии. | `security-auth` | **High** |
| **NFR-04** | **Маскирование PII в ошибках** | Ответы сервера при ошибках аутентификации (401/403) не должны раскрывать информацию о существовании пользователя или корректности пароля. | **100%** ответов с кодами 401/403 содержат общее сообщение (например, "Invalid credentials"). | Контрактные тесты (e2e/unit), проверяющие тела ответов при ошибках. | `security-auth` | **High** |
| **NFR-05** | **Логирование событий безопасности** | Все ключевые события (успешный/неуспешный вход, выход, смена пароля) должны логироваться с необходимой информацией для аудита. | Формат лога содержит: `timestamp`, `userID`, `sourceIP`, `eventType`, `status`. | E2E/Unit тесты, проверяющие наличие записей в логах - `stdout`. | `security-auth`, `observability-monitoring` | **Medium** |
| **NFR-06** | **Производительность аутентификации** | Эндпоинт входа (`/login`) должен выдерживать пиковую нагрузку с приемлемым временем ответа. | **p99 ≤ 500 мс** при нагрузке **100 RPS** на preprod-окружении. | Ручной нагрузочный тест любыми доступными методами - `Postman Load Testing` e.t.c .| `security-auth`, `availability` | **High** |
| **NFR-07** | **Безопасные атрибуты cookie сессии** | Cookie, содержащие идентификатор сессии, должны быть защищены от XSS-атак и перехвата по незащищенным каналам. | Все сессионные cookie должны иметь атрибуты: **HttpOnly, Secure, SameSite=Lax**. | E2E/Unit Тесты, проверяющие заголовки `Set-Cookie` при логине. Ревью кода. | `security-auth` | **High** |
| **NFR-08** | **Защита от CSRF-атак** | Для сессий, основанных на cookie, должна быть реализована защита от межсайтовой подделки запроса. | Все `POST/PUT/DELETE` запросы требуют **валидный `SameSite=Lax` (или `Strict`) cookie** или **анти-CSRF токен**. | E2E/Unit тесты,. Ревью кода. | `security-auth` | **High** |
